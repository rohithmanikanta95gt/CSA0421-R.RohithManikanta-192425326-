#include <stdio.h>

int mutex=1, full=0, empty=5, item=0;

int wait(int s){ return --s; }
int signal(int s){ return ++s; }

void producer(){
    mutex = wait(mutex);
    empty = wait(empty);
    item++;
    printf("Producer produced item %d\n", item);
    full = signal(full);
    mutex = signal(mutex);
}

void consumer(){
    mutex = wait(mutex);
    full = wait(full);
    printf("Consumer consumed item %d\n", item);
    item--;
    empty = signal(empty);
    mutex = signal(mutex);
}

int main(){
    int ch;
    while(1){
        printf("\n1. Produce\n2. Consume\n3. Exit\nChoice: ");
        scanf("%d",&ch);
        if(ch==1){
            if(empty>0) producer();
            else printf("Buffer Full!\n");
        }
        else if(ch==2){
            if(full>0) consumer();
            else printf("Buffer Empty!\n");
        }
        else break;
    }
}
